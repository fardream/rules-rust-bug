# Weird Behavior for `rust_library` in bazel's rules rust

## Problem

`include_str` and `include_bytes` don't work if some of the codes are generated, even if the `include` macros are called from codes that are not generated.

## Reproduction

### Include works without generated code

In this folder, [lib.rs](./lib.rs) is below

```rust
pub const BYTES: &'static str = include_str!("test.txt");
```

And the rule

```Starlark
rust_library(
    name = "include_str",
    srcs = ["lib.rs"],
    compile_data = ["test.txt"],
)
```

The below build will work

```shell
bazel build //:include_str
```

### Generated Code Works if include is not contaiend

However, if a file is generated by the rule `write_rs`, defined in [write_rs.bzl](write_rs.bzl),

```Starlark
def _write_rs(ctx):
    output = ctx.actions.declare_file(ctx.label.name)
    ctx.actions.write(
        output = output,
        content = "pub const BYTES: &'static str = \"astring\";",
    )
    return [DefaultInfo(files = depset([output]))]

write_rs = rule(implementation = _write_rs)
```

Below rule still works

```Starlark
write_rs(name = "lib2.rs")

rust_library(
    name = "gen_code",
    srcs = [
        ":lib2.rs",
    ],
)
```

```shell
bazel build //:gen_code
```

### Include with generated code don't work

However, below doesn't work

```Starlark
rust_library(
    name = "include_str_with_gen_code",
    srcs = [
        "lib.rs",
        "lib2.rs",
    ],
    compile_data = ["test.txt"],
)
```

The compiler cannot find the [test.txt](test.txt):

```shell
error: couldn't read bazel-out/darwin_arm64-fastbuild/bin/test.txt: No such file or directory (os error 2)
 --> bazel-out/darwin_arm64-fastbuild/bin/lib.rs:1:33
  |
1 | pub const BYTES: &'static str = include_str!("test.txt");
  |                                 ^^^^^^^^^^^^^^^^^^^^^^^^
  |
  = note: this error originates in the macro `include_str` (in Nightly builds, run with -Z macro-backtrace for more info)

error: aborting due to previous error

Target //:include_str_with_gen_code failed to build
Use --verbose_failures to see the command lines of failed build steps.
```
